<Window x:Class="RevitUnitLister.UnitListWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Revit Unit Lister"
        Height="650" Width="1000"
        WindowStartupLocation="CenterScreen">

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- Header -->
        <TextBlock Grid.Row="0" Text="Revit Units Explorer" FontSize="20" FontWeight="Bold" Margin="0,0,0,10" />

        <!-- Statistics -->
        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,10">
            <TextBlock Text="Quantities: " FontWeight="Bold" />
            <TextBlock x:Name="TxtTotalQuantities" Text="0" Margin="0,0,20,0" />
            <TextBlock Text="Units: " FontWeight="Bold" />
            <TextBlock x:Name="TxtTotalUnits" Text="0" Margin="0,0,20,0" />
            <TextBlock x:Name="TxtErrors" Text="Errors: 0" Foreground="Red" FontWeight="Bold" Margin="0,0,20,0"
                       Visibility="Collapsed" />
            <TextBlock x:Name="TxtWarnings" Text="Warnings: 0" Foreground="Orange" FontWeight="Bold"
                       Visibility="Collapsed" />
        </StackPanel>

        <!-- Issues Panel -->
        <Expander Grid.Row="2" x:Name="IssuesExpander" Header="Issues" Margin="0,0,0,10" Visibility="Collapsed">
            <Grid MaxHeight="150">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,5">
                    <Button x:Name="BtnShowErrors" Content="Errors" Width="80" Margin="0,0,5,0"
                            Click="BtnShowErrors_Click" />
                    <Button x:Name="BtnShowWarnings" Content="Warnings" Width="80" Click="BtnShowWarnings_Click" />
                    <Button x:Name="BtnCopyIssues" Content="Copy to Clipboard" Width="120" Margin="10,0,0,0"
                            Click="BtnCopyIssues_Click" />
                </StackPanel>

                <ListBox Grid.Row="1" x:Name="LstIssues" Margin="0,5,0,0"
                         ScrollViewer.HorizontalScrollBarVisibility="Auto"
                         FontFamily="Consolas" FontSize="11" />
            </Grid>
        </Expander>

        <!-- Main Content -->
        <Grid Grid.Row="3">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="250" />
                <ColumnDefinition Width="5" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <!-- Quantities List -->
            <DockPanel Grid.Column="0">
                <TextBlock DockPanel.Dock="Top" Text="Quantities" FontWeight="Bold" Margin="0,0,0,5" />
                <ListBox x:Name="LstQuantities"
                         SelectionChanged="LstQuantities_SelectionChanged">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <StackPanel>
                                <TextBlock Text="{Binding DisplayName}" FontWeight="SemiBold" />
                                <TextBlock Text="{Binding DisciplineName}" FontSize="10" Foreground="Gray" />
                            </StackPanel>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </DockPanel>

            <!-- Splitter -->
            <GridSplitter Grid.Column="1" Width="5" HorizontalAlignment="Stretch" />

            <!-- Units Grid -->
            <DockPanel Grid.Column="2">
                <TextBlock x:Name="TxtSelectedQuantity"
                           DockPanel.Dock="Top"
                           Text="Select a quantity"
                           FontWeight="Bold"
                           Margin="0,0,0,5" />
                <DataGrid x:Name="GridUnits"
                          AutoGenerateColumns="False"
                          IsReadOnly="True"
                          HeadersVisibility="Column">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Unit Name" Binding="{Binding DisplayName}" Width="*" />
                        <DataGridTextColumn Header="Symbol" Binding="{Binding UnitSymbol}" Width="80" />
                        <DataGridTextColumn Header="Conversion Factor"
                                            Binding="{Binding ConversionFromInternal, StringFormat=F6}"
                                            Width="120" />
                        <DataGridTextColumn Header="Type ID" Binding="{Binding TypeId}" Width="*" />
                    </DataGrid.Columns>
                </DataGrid>
            </DockPanel>
        </Grid>

        <!-- Export Buttons -->
        <StackPanel Grid.Row="4" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
            <Button x:Name="BtnExportCsv" Content="Export as CSV" Width="120" Height="30" Margin="0,0,10,0"
                    Click="BtnExportCsv_Click" />
            <Button x:Name="BtnExportJson" Content="Export as JSON" Width="120" Height="30" Click="BtnExportJson_Click" />
        </StackPanel>
    </Grid>
</Window>